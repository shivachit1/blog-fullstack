(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{92:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),s=n(21),o=n.n(s),i=n(8),u=n(14),l=n(9),d=n(6),j=n.n(d),b=n(7),p=n(19),O=n.n(p),h={logInUser:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllUsers:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},f="/api/blogs",g=null,v={getAll:function(){return O.a.get(f).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,O.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createNewComment:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("".concat(f,"/").concat(t,"/comments"),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),update:function(e,t){return O.a.put("".concat(f,"/").concat(e),t).then((function(e){return e.data}))},remove:function(e){var t={headers:{Authorization:g}};return O.a.delete("".concat(f,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){g="bearer ".concat(e)}},x=n(23),m={successMessage:"",errorMessage:""},y="",w=function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:""!==y&&clearTimeout(y),r({type:"SHOW_SUCCESS_NOTIFICATION",successMessage:e}),y=setTimeout((function(){r(C())}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},k=function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:""!==y&&clearTimeout(y),r({type:"SHOW_ERROR_NOTIFICATION",errorMessage:e}),y=setTimeout((function(){r(C())}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},C=function(){return{type:"CLEAR_NOTIFICATION"}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_SUCCESS_NOTIFICATION":return Object(x.a)(Object(x.a)({},e),{},{successMessage:t.successMessage});case"SHOW_ERROR_NOTIFICATION":return Object(x.a)(Object(x.a)({},e),{},{errorMessage:t.errorMessage});case"CLEAR_NOTIFICATION":return{successMessage:"",errorMessage:""};default:return e}},S={username:"",name:"",token:""},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":case"SAVE_USER":return t.payload;case"LOGOUT":return S;default:return e}},T=n(99),L=n(98),E=n(95),_=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.loggedUser}));return Object(r.jsxs)(T.a,{collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light",children:[Object(r.jsx)(T.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(r.jsx)(T.a.Collapse,{id:"responsive-navbar-nav",children:Object(r.jsxs)(L.a,{className:"mr-auto",children:[Object(r.jsx)(L.a.Link,{href:"#",as:"span",children:Object(r.jsx)(u.b,{style:{margin:10,fontSize:20,fontWeight:"bold"},to:"/blogs",children:"Blogs"})}),Object(r.jsx)(L.a.Link,{href:"#",as:"span",children:Object(r.jsx)(u.b,{style:{margin:10,fontSize:20,fontWeight:"bold"},to:"/users",children:"Users"})}),Object(r.jsx)(L.a.Link,{href:"#",as:"span",children:t?Object(r.jsxs)("div",{children:[Object(r.jsx)("strong",{children:t.name})," logged in ",Object(r.jsx)(E.a,{variant:"danger",onClick:function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT"}),window.localStorage.removeItem("loggedBlogappUser");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Logout"})]}):Object(r.jsx)(u.b,{style:{margin:10},to:"/login",children:"login"})})]})})]})},U=n(100),A=function(){var e=Object(i.c)((function(e){return e.notification.successMessage})),t=Object(i.c)((function(e){return e.notification.errorMessage}));return""===e&&""===t?null:""!==t?Object(r.jsx)(U.a,{variant:"danger",children:t}):""!==e?Object(r.jsx)(U.a,{variant:"success",children:e}):void 0},B=n(26),M=n(97),R=function(){Object(l.f)();var e=Object(i.b)(),t=Object(a.useState)(""),n=Object(B.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(""),u=Object(B.a)(o,2),d=u[0],p=u[1],O=function(e){"username"===e.target.name?s(e.target.value):"password"===e.target.name&&p(e.target.value)};return Object(r.jsxs)("div",{className:"loginForm",children:[Object(r.jsx)("h2",{children:"Log in to application"}),Object(r.jsx)(M.a,{onSubmit:function(t){var n;t.preventDefault(),e((n={username:c,password:d},function(){var e=Object(b.a)(j.a.mark((function e(t){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.logInUser(n);case 3:r=e.sent,t({type:"LOGIN",payload:r}),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),v.setToken(r.token),t(w("".concat(r.name," logged In"),5e3)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t(k("wrong credentials",5e3));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())),s(""),p("")},children:Object(r.jsxs)(M.a.Group,{children:[Object(r.jsx)(M.a.Label,{children:"username:"}),Object(r.jsx)(M.a.Control,{type:"text",name:"username",value:c,placeholder:"username",onChange:O}),Object(r.jsx)(M.a.Label,{children:"password:"}),Object(r.jsx)(M.a.Control,{type:"password",name:"password",value:d,placeholder:"password",onChange:O,autoComplete:"off"}),Object(r.jsx)(E.a,{variant:"primary",type:"submit",children:"login"})]})})]})},G=n(36),W=n(62),F=function(e){return e.sort((function(e,t){return t.likes-e.likes}))},V=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.create(e);case 3:r=t.sent,n({type:"NEW_BLOG",payload:r}),n(w("a new blog ".concat(r.title," by ").concat(r.author," added"),3e3)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(k("Error creating new blog",5e3));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},H=function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log(e+t),n.next=4,v.createNewComment(e,t);case 4:a=n.sent,r({type:"NEW_COMMENT",payload:a}),r(w("a comment added to the blog",3e3)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),r(k("Error commenting on blog",5e3));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return F(t.payload);case"NEW_BLOG":return[].concat(Object(W.a)(e),[t.payload]);case"LIKE":var n=t.payload,r=e.map((function(e){return e.id===n.id?n:e}));return F(r);case"REMOVE_BLOG":var a=t.payload,c=e.filter((function(e){return e.id!==a}));return F(c);case"NEW_COMMENT":var s=t.payload,o=e.map((function(e){return e.id===s.id?s:e}));return F(o);default:return e}},D=function(e){var t=e.toggle,n=Object(i.b)(),c=Object(a.useState)({title:"",author:"",url:""}),s=Object(B.a)(c,2),o=s[0],u=s[1],l=function(e){var t=e.target,n=t.name,r=t.value;u((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(G.a)({},n,r))}))},d=function(){var e=Object(b.a)(j.a.mark((function e(r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),n(V(o)),t.current.toggleVisibility(),u({title:"",author:"",url:""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Create new Blog"}),Object(r.jsx)(M.a,{onSubmit:d,children:Object(r.jsxs)(M.a.Group,{children:[Object(r.jsx)(M.a.Label,{children:"Title:"}),Object(r.jsx)(M.a.Control,{id:"title",name:"title",value:o.title,placeholder:"Title",onChange:l}),Object(r.jsx)(M.a.Label,{children:"Author:"}),Object(r.jsx)(M.a.Control,{id:"author",name:"author",value:o.author,placeholder:"Author",onChange:l}),Object(r.jsx)(M.a.Label,{children:"URL:"}),Object(r.jsx)(M.a.Control,{id:"url",name:"url",value:o.url,placeholder:"Url",onChange:l}),Object(r.jsx)(E.a,{style:{marginTop:10,marginBottom:10},variant:"primary",type:"submit",children:"create"})]})})]})},J=n(101),K=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(B.a)(n,2),s=c[0],o=c[1],i={display:s?"none":""},u={display:s?"":"none"},l=function(){o(!s)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(r.jsxs)(J.a,{className:"my-auto",style:{padding:25},children:[Object(r.jsx)("div",{style:i,children:Object(r.jsx)(E.a,{variant:"success",onClick:l,children:e.buttonLabel})}),Object(r.jsxs)("div",{style:u,className:"togglableContent",children:[e.children,Object(r.jsx)(E.a,{variant:"danger",onClick:l,children:"cancel"})]})]})}));K.displayName="Togglable";var q=K,P=function(e){var t=e.blog;return Object(r.jsx)(J.a,{style:{padding:15,margin:10,border:"solid",borderWidth:1,borderColor:"green",marginBottom:8},id:"blog",children:Object(r.jsx)(u.b,{to:"/blogs/".concat(t.id),className:"blogTitle",children:Object(r.jsxs)("h6",{children:[t.title," ",t.author]})})})},Q=function(){var e=Object(i.c)((function(e){return e.blogs}));return Object(r.jsx)("div",{children:e.map((function(e){return Object(r.jsx)(P,{blog:e},e.id)}))})},X=n(96),Y=function(){var e=Object(i.c)((function(e){return e.users}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"Users"}),Object(r.jsx)(X.a,{striped:!0,children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{}),Object(r.jsx)("th",{children:"blogs created"})]}),e.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:Object(r.jsx)(u.b,{to:"/users/".concat(e.id),children:e.username})}),Object(r.jsx)("td",{children:e.blogs.length})]},e.id)}))]})})]})},Z=function(){var e=Object(l.g)().id,t=Object(i.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return t?Object(r.jsxs)(J.a,{style:{padding:20},children:[Object(r.jsx)("h4",{children:t.name}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h5",{children:"added blogs"}),Object(r.jsx)("ul",{children:t.blogs.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)("li",{children:e.title})},e.id)}))})]})]}):null},$=function(){var e=Object(i.b)(),t=Object(l.g)().id,n=Object(i.c)((function(e){return e.loggedUser})),a=Object(i.c)((function(e){return e.blogs.find((function(e){return e.id===t}))}));if(!a)return null;var c=function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r={comment:n.target.comment.value},e(H(a.id,r)),n.target.comment.value="";case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(r.jsx)(J.a,{className:"my-auto",style:{padding:20},children:Object(r.jsx)("div",{children:Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{children:a.title}),Object(r.jsx)("a",{href:a.url,children:a.url}),Object(r.jsxs)("p",{children:[a.likes," likes",Object(r.jsx)(E.a,{className:"likeButton",variant:"info",onClick:function(){var t={title:a.title,author:a.author,url:a.url,likes:a.likes+1,user:a.user.id};e(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.update(e,t);case 3:a=n.sent,r({type:"LIKE",payload:a}),r(w("".concat(a.title," likes increased by 1"),5e3)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r(k("Blog cannot be updated",5e3));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(a.id,t))},children:"like"})]}),Object(r.jsxs)("p",{children:["added by ",a.user.name]}),n.username===a.user.username?Object(r.jsx)(E.a,{className:"deleteButton",variant:"danger",onClick:function(){var t;window.confirm("Remove blog ".concat(a.title," by ").concat(a.author))?e((t=a.id,function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.remove(t);case 3:n({type:"REMOVE_BLOG",payload:t}),n(w("blog is deleted",5e3)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(k("Blog cannot be deleted",5e3));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())):console.log("delete blog cancelled")},children:"delete"}):Object(r.jsx)("div",{}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h5",{children:"comments"}),Object(r.jsxs)("form",{onSubmit:c,children:[Object(r.jsx)("input",{name:"comment",placeholder:"leave comment here"}),Object(r.jsx)(E.a,{type:"submit",style:{marginLeft:15},variant:"success",children:"add comment"})]}),Object(r.jsx)("ul",{children:a.comments.map((function(e){return Object(r.jsx)("li",{children:e},e)}))})]})]})})})},ee=function(){var e=Object(i.c)((function(e){return e.loggedUser})),t=Object(a.useRef)(),n=Object(i.b)();return Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);n(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SAVE_USER",payload:e}),v.setToken(e.token),n(w("".concat(e.name," logged In"),5e3));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}n(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getAllUsers();case 2:n=e.sent,t({type:"GET_ALL_USERS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[n]),Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(A,{}),Object(r.jsx)(u.a,{children:e.username?Object(r.jsxs)("div",{children:[Object(r.jsx)(_,{}),Object(r.jsx)("h2",{children:"blogs app"}),Object(r.jsx)(l.b,{exact:!0,path:"/",render:function(){return e?Object(r.jsx)(l.a,{to:"/blogs"}):Object(r.jsx)(l.a,{to:"/"})}}),Object(r.jsxs)(l.b,{exact:!0,path:"/blogs",children:[Object(r.jsx)(q,{buttonLabel:"Create New Blog",ref:t,children:Object(r.jsx)(D,{toggle:t})}),Object(r.jsx)(Q,{})]}),Object(r.jsx)(l.b,{path:"/blogs/:id",children:Object(r.jsx)($,{})}),Object(r.jsx)(l.b,{exact:!0,path:"/users",children:Object(r.jsx)(Y,{})}),Object(r.jsx)(l.b,{path:"/users/:id",children:Object(r.jsx)(Z,{})})]}):Object(r.jsx)(R,{})})]})},te=n(25),ne=n(60),re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL_USERS":return t.payload;default:return e}},ae=n(61),ce=Object(te.combineReducers)({blogs:z,loggedUser:I,users:re,notification:N}),se=Object(te.createStore)(ce,Object(ae.composeWithDevTools)(Object(te.applyMiddleware)(ne.a)));n(92);o.a.render(Object(r.jsx)(i.a,{store:se,children:Object(r.jsx)(ee,{})}),document.getElementById("root"))}},[[93,1,2]]]);
//# sourceMappingURL=main.9072ea78.chunk.js.map