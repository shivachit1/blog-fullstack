(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{62:function(e,t,n){e.exports=n(92)},91:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),l=n.n(c),o=n(7),u=n(13),s=n(8),i=n(5),m=n.n(i),p=n(6),d=n(18),f=n.n(d),g={logInUser:function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllUsers:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},b=null,v={getAll:function(){return f.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:b}},e.next=3,f.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createNewComment:function(){var e=Object(p.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("".concat("/api/blogs","/").concat(t,"/comments"),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),update:function(e,t){return f.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},remove:function(e){var t={headers:{Authorization:b}};return f.a.delete("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){b="bearer ".concat(e)}},E=n(22),h={successMessage:"",errorMessage:""},O="",y=function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(a){return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:""!==O&&clearTimeout(O),a({type:"SHOW_SUCCESS_NOTIFICATION",successMessage:e}),O=setTimeout((function(){a(j())}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},w=function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(a){return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:""!==O&&clearTimeout(O),a({type:"SHOW_ERROR_NOTIFICATION",errorMessage:e}),O=setTimeout((function(){a(j())}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},j=function(){return{type:"CLEAR_NOTIFICATION"}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_SUCCESS_NOTIFICATION":return Object(E.a)(Object(E.a)({},e),{},{successMessage:t.successMessage});case"SHOW_ERROR_NOTIFICATION":return Object(E.a)(Object(E.a)({},e),{},{errorMessage:t.errorMessage});case"CLEAR_NOTIFICATION":return{successMessage:"",errorMessage:""};default:return e}},x={username:"",name:"",token:""},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":case"SAVE_USER":return t.payload;case"LOGOUT":return x;default:return e}},N=n(98),S=n(97),I=n(94),T=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.loggedUser}));return r.a.createElement(N.a,{collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light"},r.a.createElement(N.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(N.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(S.a,{className:"mr-auto"},r.a.createElement(S.a.Link,{href:"#",as:"span"},r.a.createElement(u.b,{style:{margin:10,fontSize:20,fontWeight:"bold"},to:"/blogs"},"Blogs")),r.a.createElement(S.a.Link,{href:"#",as:"span"},r.a.createElement(u.b,{style:{margin:10,fontSize:20,fontWeight:"bold"},to:"/users"},"Users")),r.a.createElement(S.a.Link,{href:"#",as:"span"},t?r.a.createElement("div",null,r.a.createElement("strong",null,t.name)," logged in ",r.a.createElement(I.a,{variant:"danger",onClick:function(){e(function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT"}),window.localStorage.removeItem("loggedBlogappUser");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"Logout")):r.a.createElement(u.b,{style:{margin:10},to:"/login"},"login")))))},L=n(99),_=function(){var e=Object(o.c)((function(e){return e.notification.successMessage})),t=Object(o.c)((function(e){return e.notification.errorMessage}));return""===e&&""===t?null:""!==t?r.a.createElement(L.a,{variant:"danger"},t):""!==e?r.a.createElement(L.a,{variant:"success"},e):void 0},U=n(25),A=n(96),B=function(){var e=Object(s.f)(),t=Object(o.b)(),n=Object(a.useState)(""),c=Object(U.a)(n,2),l=c[0],u=c[1],i=Object(a.useState)(""),d=Object(U.a)(i,2),f=d[0],b=d[1],E=function(e){"username"===e.target.name?u(e.target.value):"password"===e.target.name&&b(e.target.value)};return r.a.createElement("div",{className:"loginForm"},r.a.createElement("h2",null,"Log in to application"),r.a.createElement(A.a,{onSubmit:function(n){var a;n.preventDefault(),t((a={username:l,password:f},function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.logInUser(a);case 3:n=e.sent,t({type:"LOGIN",payload:n}),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),v.setToken(n.token),t(y("".concat(n.name," logged In"),5e3)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t(w("wrong credentials",5e3));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())),u(""),b(""),e.push("/blogs",{from:"LoginForm"})}},r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"username:"),r.a.createElement(A.a.Control,{type:"text",name:"username",value:l,placeholder:"username",onChange:E}),r.a.createElement(A.a.Label,null,"password:"),r.a.createElement(A.a.Control,{type:"password",name:"password",value:f,placeholder:"password",onChange:E,autoComplete:"off"}),r.a.createElement(I.a,{variant:"primary",type:"submit"},"login"))))},M=n(35),R=n(61),G=function(e){return e.sort((function(e,t){return t.likes-e.likes}))},W=function(e){return function(){var t=Object(p.a)(m.a.mark((function t(n){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.create(e);case 3:a=t.sent,n({type:"NEW_BLOG",payload:a}),n(y("a new blog ".concat(a.title," by ").concat(a.author," added"),3e3)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(w("Error creating new blog",5e3));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},F=function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(a){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log(e+t),n.next=4,v.createNewComment(e,t);case 4:r=n.sent,a({type:"NEW_COMMENT",payload:r}),a(y("a comment added to the blog",3e3)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),a(w("Error commenting on blog",5e3));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return G(t.payload);case"NEW_BLOG":return[].concat(Object(R.a)(e),[t.payload]);case"LIKE":var n=t.payload,a=e.map((function(e){return e.id===n.id?n:e}));return G(a);case"REMOVE_BLOG":var r=t.payload,c=e.filter((function(e){return e.id!==r}));return G(c);case"NEW_COMMENT":var l=t.payload,o=e.map((function(e){return e.id===l.id?l:e}));return G(o);default:return e}},H=function(e){var t=e.toggle,n=Object(o.b)(),c=Object(a.useState)({title:"",author:"",url:""}),l=Object(U.a)(c,2),u=l[0],s=l[1],i=function(e){var t=e.target,n=t.name,a=t.value;s((function(e){return Object(E.a)(Object(E.a)({},e),{},Object(M.a)({},n,a))}))},d=function(){var e=Object(p.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),n(W(u)),t.current.toggleVisibility(),s({title:"",author:"",url:""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h2",null,"Create new Blog"),r.a.createElement(A.a,{onSubmit:d},r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"Title:"),r.a.createElement(A.a.Control,{id:"title",name:"title",value:u.title,placeholder:"Title",onChange:i}),r.a.createElement(A.a.Label,null,"Author:"),r.a.createElement(A.a.Control,{id:"author",name:"author",value:u.author,placeholder:"Author",onChange:i}),r.a.createElement(A.a.Label,null,"URL:"),r.a.createElement(A.a.Control,{id:"url",name:"url",value:u.url,placeholder:"Url",onChange:i}),r.a.createElement(I.a,{style:{marginTop:10,marginBottom:10},variant:"primary",type:"submit"},"create"))))},z=n(100),D=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(U.a)(n,2),l=c[0],o=c[1],u={display:l?"none":""},s={display:l?"":"none"},i=function(){o(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement(z.a,{className:"my-auto",style:{padding:25}},r.a.createElement("div",{style:u},r.a.createElement(I.a,{variant:"success",onClick:i},e.buttonLabel)),r.a.createElement("div",{style:s,className:"togglableContent"},e.children,r.a.createElement(I.a,{variant:"danger",onClick:i},"cancel")))}));D.displayName="Togglable";var J=D,K=function(e){var t=e.blog;return r.a.createElement(z.a,{style:{padding:15,margin:10,border:"solid",borderWidth:1,borderColor:"green",marginBottom:8},id:"blog"},r.a.createElement(u.b,{to:"/blogs/".concat(t.id),className:"blogTitle"},r.a.createElement("h6",null,t.title," ",t.author)))},q=function(){var e=Object(o.c)((function(e){return e.blogs}));return r.a.createElement("div",null,e.map((function(e){return r.a.createElement(K,{key:e.id,blog:e})})))},P=n(95),Q=function(){var e=Object(o.c)((function(e){return e.users}));return r.a.createElement("div",null,r.a.createElement("h3",null,"Users"),r.a.createElement(P.a,{striped:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"blogs created")),e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(u.b,{to:"/users/".concat(e.id)},e.username)),r.a.createElement("td",null,e.blogs.length))})))))},X=function(){var e=Object(s.g)().id,t=Object(o.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return t?r.a.createElement(z.a,{style:{padding:20}},r.a.createElement("h4",null,t.name),r.a.createElement("div",null,r.a.createElement("h5",null,"added blogs"),r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("li",null,e.title))}))))):null},Y=function(){var e=Object(o.b)(),t=Object(s.g)().id,n=Object(o.c)((function(e){return e.loggedUser})),a=Object(o.c)((function(e){return e.blogs.find((function(e){return e.id===t}))}));if(!a)return null;var c=function(){var t=Object(p.a)(m.a.mark((function t(n){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r={comment:n.target.comment.value},e(F(a.id,r)),n.target.comment.value="";case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(z.a,{className:"my-auto",style:{padding:20}},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h4",null,a.title),r.a.createElement("a",{href:a.url},a.url),r.a.createElement("p",null,a.likes," likes",r.a.createElement(I.a,{className:"likeButton",variant:"info",onClick:function(){var t={title:a.title,author:a.author,url:a.url,likes:a.likes+1,user:a.user.id};e(function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(a){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.update(e,t);case 3:r=n.sent,a({type:"LIKE",payload:r}),a(y("".concat(r.title," likes increased by 1"),5e3)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),a(w("Blog cannot be updated",5e3));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(a.id,t))}},"like")),r.a.createElement("p",null,"added by ",a.user.name),n.username===a.user.username?r.a.createElement(I.a,{className:"deleteButton",variant:"danger",onClick:function(){var t;window.confirm("Remove blog ".concat(a.title," by ").concat(a.author))?e((t=a.id,function(){var e=Object(p.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.remove(t);case 3:n({type:"REMOVE_BLOG",payload:t}),n(y("blog is deleted",5e3)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(w("Blog cannot be deleted",5e3));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())):console.log("delete blog cancelled")}},"delete"):r.a.createElement("div",null),r.a.createElement("div",null,r.a.createElement("h5",null,"comments"),r.a.createElement("form",{onSubmit:c},r.a.createElement("input",{name:"comment",placeholder:"leave comment here"}),r.a.createElement(I.a,{type:"submit",style:{marginLeft:15},variant:"success"},"add comment")),r.a.createElement("ul",null,a.comments.map((function(e){return r.a.createElement("li",{key:e},e)})))))))},Z=function(){var e=Object(o.c)((function(e){return e.loggedUser})),t=Object(a.useRef)(),n=Object(o.b)();return Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);n(function(e){return function(){var t=Object(p.a)(m.a.mark((function t(n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SAVE_USER",payload:e}),v.setToken(e.token),n(y("".concat(e.name," logged In"),5e3));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}n(function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getAllUsers();case 2:n=e.sent,t({type:"GET_ALL_USERS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n(function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[n]),r.a.createElement("div",{className:"container"},r.a.createElement(_,null),r.a.createElement(u.a,null,e.username?r.a.createElement("div",null,r.a.createElement(T,null),r.a.createElement("h2",null,"blogs app"),r.a.createElement(s.b,{exact:!0,path:"/",render:function(){return e?r.a.createElement(s.a,{to:"/blogs"}):r.a.createElement(s.a,{to:"/"})}}),r.a.createElement(s.b,{exact:!0,path:"/blogs"},r.a.createElement(J,{buttonLabel:"Create New Blog",ref:t},r.a.createElement(H,{toggle:t})),r.a.createElement(q,null)),r.a.createElement(s.b,{path:"/blogs/:id"},r.a.createElement(Y,null)),r.a.createElement(s.b,{exact:!0,path:"/users"},r.a.createElement(Q,null)),r.a.createElement(s.b,{path:"/users/:id"},r.a.createElement(X,null))):r.a.createElement(B,null)))},$=n(24),ee=n(59),te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL_USERS":return t.payload;default:return e}},ne=n(60),ae=Object($.combineReducers)({blogs:V,loggedUser:C,users:te,notification:k}),re=Object($.createStore)(ae,Object(ne.composeWithDevTools)(Object($.applyMiddleware)(ee.a)));n(91);l.a.render(r.a.createElement(o.a,{store:re},r.a.createElement(Z,null)),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.b3843272.chunk.js.map